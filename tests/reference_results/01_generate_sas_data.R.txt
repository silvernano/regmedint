### Running: /home/kyoshida/miniconda3/lib/R/bin/exec/R --no-echo --no-restore --file=01_generate_sas_data.R 
> 
> cat("
+ ###
+ ### Prepare environment
+ ################################################################################\n")

###
### Prepare environment
################################################################################
> 
> ## Record start time
> start_time <- Sys.time()
> cat("### Started ", as.character(start_time), "\n")
### Started  2020-09-06 06:55:52 
> 
> ## Load packages
> library(survival)
> library(tableone)
> library(tidyverse)
── Attaching packages ─────────────────────────────────────────────────────────── tidyverse 1.3.0 ──
✔ ggplot2 3.3.1     ✔ purrr   0.3.4
✔ tibble  3.0.1     ✔ dplyr   1.0.0
✔ tidyr   1.1.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
> 
> 
> cat("
+ ###
+ ### Load data
+ ################################################################################\n")

###
### Load data
################################################################################
> 
> data(pbc)
> 
> 
> cat("
+ ###
+ ### Manipulate
+ ################################################################################\n")

###
### Manipulate
################################################################################
> 
> ## For the purpose of this cross testing, complete case analysis is fine.
> pbc_cc <- pbc %>%
+     as_tibble() %>%
+     ## Missing data should be warned in validate_args()
+     drop_na() %>%
+     mutate(male = if_else(sex == "m", 1L, 0L),
+            ## Combine transplant and death for testing purpose
+            status = if_else(status == 0, 0L, 1L),
+            ## censoring status reverse coded for SAS macro
+            cens = if_else(status == 1L, 0L, 1L),
+            ## Binary mvar
+            bili_bin = if_else(bili > median(bili), 1L, 0L),
+            alk_phos = alk.phos) %>%
+     select(
+         ## avar
+         trt,
+         ##
+         ## mvar (continuous)
+         bili,
+         ## mvar (binary)
+         bili_bin,
+         ##
+         ## yvar (continuous)
+         alk_phos,
+         ## yvar (binary)
+         spiders,
+         ## yvar (count)
+         platelet,
+         ## yvar (survival)
+         time,
+         ## eventvar (survival)
+         status,
+         ## censvar (survival)
+         cens,
+         ##
+         ## cvar (continuous/binary/handled continuous)
+         age, male, stage
+     )
> 
> 
> cat("
+ ###
+ ### Show resulting data
+ ################################################################################\n")

###
### Show resulting data
################################################################################
> 
> tab1 <- CreateTableOne(data = pbc_cc,
+                        vars = c("bili","bili_bin",
+                                 "alk_phos","spiders","platelet","time","status","cens",
+                                 "age","male","stage"),
+                        strata = c("trt"),
+                        test = FALSE)
> print(tab1, smd = TRUE)
                      Stratified by trt
                       1                 2                 SMD   
  n                        136               140                 
  bili (mean (SD))        2.96 (3.66)       3.70 (5.35)     0.162
  bili_bin (mean (SD))    0.50 (0.50)       0.48 (0.50)     0.043
  alk_phos (mean (SD)) 2016.74 (2132.41) 1977.05 (2106.37)  0.019
  spiders (mean (SD))     0.29 (0.46)       0.29 (0.45)     0.018
  platelet (mean (SD))  258.06 (97.83)    265.38 (88.53)    0.078
  time (mean (SD))     1957.39 (1088.45) 2000.32 (1138.66)  0.039
  status (mean (SD))      0.49 (0.50)       0.45 (0.50)     0.071
  cens (mean (SD))        0.51 (0.50)       0.55 (0.50)     0.071
  age (mean (SD))        51.16 (11.04)     48.47 (9.85)     0.257
  male (mean (SD))        0.15 (0.36)       0.10 (0.30)     0.143
  stage (mean (SD))       2.97 (0.91)       3.11 (0.79)     0.160
> 
> 
> cat("
+ ###
+ ### Write to a CSV file for SAS
+ ################################################################################\n")

###
### Write to a CSV file for SAS
################################################################################
> 
> write_csv(pbc_cc,
+           path = "./data-pbc_cc.csv")
> 
> 
> ################################################################################
> cat("
+ ###
+ ### Record package versions etc
+ ################################################################################\n")

###
### Record package versions etc
################################################################################
> print(sessionInfo())
R version 4.0.0 (2020-04-24)
Platform: x86_64-conda_cos6-linux-gnu (64-bit)
Running under: Red Hat Enterprise Linux Server release 6.10 (Santiago)

Matrix products: default
BLAS/LAPACK: /home/kyoshida/miniconda3/lib/libopenblasp-r0.3.9.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.0   stringr_1.4.0   dplyr_1.0.0     purrr_0.3.4     readr_1.3.1     tidyr_1.1.0    
 [7] tibble_3.0.1    ggplot2_3.3.1   tidyverse_1.3.0 tableone_0.11.1 survival_3.1-12

loaded via a namespace (and not attached):
 [1] tidyselect_1.1.0 mitools_2.4      splines_4.0.0    haven_2.3.1      lattice_0.20-41 
 [6] labelled_2.4.0   colorspace_1.4-1 vctrs_0.3.1      generics_0.0.2   blob_1.2.1      
[11] rlang_0.4.6      e1071_1.7-3      pillar_1.4.4     glue_1.4.1       withr_2.2.0     
[16] DBI_1.1.0        dbplyr_1.4.4     modelr_0.1.8     readxl_1.3.1     lifecycle_0.2.0 
[21] munsell_0.5.0    gtable_0.3.0     cellranger_1.1.0 rvest_0.3.5      class_7.3-17    
[26] fansi_0.4.1      broom_0.5.6      Rcpp_1.0.4.6     scales_1.1.1     backports_1.1.7 
[31] jsonlite_1.6.1   fs_1.4.1         hms_0.5.3        stringi_1.4.6    survey_4.0      
[36] grid_4.0.0       cli_2.0.2        tools_4.0.0      magrittr_1.5     crayon_1.3.4    
[41] pkgconfig_2.0.3  ellipsis_0.3.1   Matrix_1.2-18    xml2_1.3.2       reprex_0.3.0    
[46] lubridate_1.7.8  assertthat_0.2.1 httr_1.4.1       rstudioapi_0.11  R6_2.4.1        
[51] nlme_3.1-148     compiler_4.0.0  
> ## Record execution time and multicore use
> end_time <- Sys.time()
> diff_time <- difftime(end_time, start_time, units = "auto")
> 
